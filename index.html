<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cartinha com Imagem Ajustada</title>
<style>
:root{
  --bg: #fff6fb;
  --pink-1: #ffb6d5;
  --pink-2: #ff7fbf;
  --paper: #fff;
  --shadow: rgba(0,0,0,0.12);
}

html,body{
  height:100%;
  margin:0;
  font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(180deg, var(--bg) 0%, #fff 100%);
  display:flex;
  align-items:center;
  justify-content:center;
}

.scene{
  width:380px;
  height:420px;
  display:flex;
  align-items:center;
  justify-content:center;
  perspective:1000px;
}

.envelope {
  width:360px;
  height:260px;
  position:relative;
  cursor:pointer;
  transform-style:preserve-3d;
  transition:transform 400ms ease;
}

.env-back {
  position:absolute;
  inset:0;
  background: linear-gradient(180deg,#fff 0%, #fff0 100%);
  border-radius:10px;
  box-shadow: 0 10px 20px var(--shadow);
  border: 1px solid rgba(0,0,0,0.05);
  overflow:hidden;
}

.env-flap {
  position:absolute;
  left:0;
  right:0;
  top:-1px;
  height:120px;
  background: linear-gradient(180deg, var(--pink-1), var(--pink-2));
  transform-origin: 50% 100%;
  border-radius:10px 10px 0 0;
  box-shadow: 0 6px 18px rgba(0,0,0,0.12);
  display:flex;
  align-items:flex-end;
  justify-content:center;
  transition: transform 500ms cubic-bezier(.2,.9,.2,1), box-shadow 300ms ease;
  z-index:6; /* inicialmente flap na frente */
}

.env-flap::after{
  content:'';
  width:180px;
  height:80px;
  background: linear-gradient(180deg, rgba(255,255,255,0.4), rgba(255,255,255,0.05));
  border-radius: 0 0 90px 90px;
  transform:translateY(22px);
  display:block;
  opacity:0.9;
}

.paper {
  position:absolute;
  left:50%;
  transform:translateX(-50%) translateY(18%);
  top:10px;
  width:90%;
  height:78%;
  background: linear-gradient(180deg, var(--paper), #fff);
  border-radius:8px;
  box-shadow: 0 8px 18px rgba(0,0,0,0.08);
  z-index:5; /* papel na frente do flap ao abrir */
  transition: transform 700ms cubic-bezier(.16,1,.3,1), opacity 300ms ease;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  padding:20px;
  opacity:0;
}

.paper img {
  max-width:60%;
  max-height:100px;
  border-radius:12px;
  margin-bottom:12px;
  opacity:0;
  transition: opacity 1s ease;
}

.paper .mensagem {
  text-align:center;
  font-weight:700;
  font-size:22px;
  line-height:1.2;
  color:#ff2fa3;
  background: linear-gradient(90deg, #ff2fa3 0%, #ff87c6 50%, #ffffff 100%);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  white-space: pre-wrap;
}

.envelope.open .env-flap {
  transform: rotateX(180deg);
  box-shadow: 0 18px 28px rgba(0,0,0,0.18);
  z-index:2; /* flap atr√°s do papel */
}

.envelope.open .paper {
  transform:translateX(-50%) translateY(-18%);
  opacity:1;
}

.sparkle {
  position:absolute;
  width:12px;
  height:12px;
  border-radius:50%;
  top:12px;
  right:18px;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.95), rgba(255,255,255,0.4));
  filter: blur(4px);
  opacity:0.8;
  z-index:8;
  transform: scale(0.9);
}

.confete {
  position:absolute;
  width:10px;
  height:10px;
  border-radius:50%;
  opacity:0.9;
  z-index:9;
  animation-name:caindo;
  animation-timing-function: linear;
}

@keyframes caindo {
  0% { transform: translateY(0) rotate(0deg); opacity:1; }
  100% { transform: translateY(250px) rotate(360deg); opacity:0; }
}

.controls{
  margin-top:14px;
  display:flex;
  gap:10px;
  justify-content:center;
  width:100%;
}
button {
  border:0;
  padding:10px 14px;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
  box-shadow: 0 6px 12px rgba(0,0,0,0.06);
}
.btn-open{
  background: linear-gradient(90deg, #ff7fbf, #ffb6d5);
  color:white;
}
.btn-reset{
  background: white;
  color:#ff2fa3;
  border:1px solid rgba(255,47,163,0.12);
}

@media (max-width:500px){
  .scene{ transform: scale(0.75); }
  .paper .mensagem { font-size:18px; }
  .paper img { max-height:80px; }
}
</style>
</head>
<body>
<main style="text-align:center;">
  <div class="scene">
    <div id="envelope" class="envelope">
      <div class="env-back"></div>

      <div class="paper" id="paper">
        <img id="imagemCarta" src="vaquinha.jpg" alt="Imagem da carta" />
        <div class="mensagem" id="mensagem"></div>
      </div>

      <div class="env-flap"></div>
      <div class="sparkle"></div>
    </div>
  </div>

  <div class="controls">
    <button id="btn-open" class="btn-open">Abrir Cartinha</button>
    <button id="btn-reset" class="btn-reset">Fechar / Resetar</button>
  </div>

  <audio id="som-papel" src="https://assets.codepen.io/3/paper-flip.mp3" preload="auto"></audio>
</main>

<script>
(function(){
  const envelope = document.getElementById('envelope');
  const btnOpen = document.getElementById('btn-open');
  const btnReset = document.getElementById('btn-reset');
  const paper = document.getElementById('paper');
  const mensagem = document.getElementById('mensagem');
  const imagemCarta = document.getElementById('imagemCarta');
  const somPapel = document.getElementById('som-papel');

  const texto = "bote o pau na mesa e mande medir";

  function escreverTexto(texto){
    mensagem.textContent = "";
    let i = 0;
    const interval = setInterval(()=>{
      mensagem.textContent += texto[i];
      i++;
      if(i >= texto.length) clearInterval(interval);
    }, 100);
  }

  function criarConfetes(){
    const cores = ['#ffb6d5','#ff7fbf','#ffc0cb','#fff0f5','#ffe4e1'];
    const confetes = [];
    for(let i=0;i<25;i++){
      const c = document.createElement('div');
      c.classList.add('confete');
      c.style.backgroundColor = cores[Math.floor(Math.random()*cores.length)];
      c.style.left = Math.random()*360+'px';
      c.style.animationDuration = (1+Math.random()*1.2)+'s';
      c.style.animationDelay = Math.random()*0.5+'s';
      envelope.appendChild(c);
      confetes.push(c);
    }
    return confetes;
  }

  function limparConfetes(confetes){
    confetes.forEach(c => envelope.removeChild(c));
  }

  function setOpen(open){
    if(open){
      envelope.classList.add('open');
      paper.setAttribute('aria-hidden','false');
      btnOpen.textContent = 'Cartinha Aberta';
      somPapel.currentTime=0;
      somPapel.play();
      imagemCarta.style.opacity=0;
      escreverTexto(texto);
      // fade imagem
      setTimeout(()=>{ imagemCarta.style.opacity=1; },300);

      const confetes = criarConfetes();
      setTimeout(()=>limparConfetes(confetes),1800);
    } else {
      envelope.classList.remove('open');
      paper.setAttribute('aria-hidden','true');
      btnOpen.textContent = 'Abrir Cartinha';
      mensagem.textContent = "";
      imagemCarta.style.opacity=0;
    }
  }

  envelope.addEventListener('click', () => setOpen(!envelope.classList.contains('open')));
  btnOpen.addEventListener('click', () => setOpen(true));
  btnReset.addEventListener('click', () => setOpen(false));
})();
</script>
</body>
</html>
